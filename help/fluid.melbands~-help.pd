#N canvas 46 25 694 792 12;
#X obj 17 13 cnv 15 660 42 empty empty fluid.melbands~ 1 22 0 36 #4ba3fb #ffffff 0;
#X obj 17 60 cnv 15 488 17 empty empty A\ perceptually\ spread\ spectral\ contour\ descriptor 4 8 0 13 #e0e0e0 #404040 0;
#X text 15 84 Magnitudes for a number of perceptually evenly spread bands.;
#X obj 509 60 fluid.referencelauncher fluid.melbands~.html reference/melbands/;
#X obj 17 149 fluid.demosound~;
#X obj 87 747 cnv 15 15 15 empty empty empty 20 12 0 14 #c6ffc7 #404040 0;
#X obj 16 742 fluid.out~ nmffilterhelp;
#N canvas 1622 -867 388 477 srcselect 0;
#X obj 60 71 inlet~;
#X obj 140 71 inlet~;
#X obj 221 71 inlet;
#X obj 62 371 +~;
#X obj 62 395 outlet~;
#X obj 221 150 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000 0 1;
#X msg 219 266 \$1 10;
#X obj 219 292 line~;
#X obj 273 71 loadbang;
#X msg 273 96 0;
#X msg 78 266 \$1 10;
#X obj 78 294 line~;
#X obj 60 330 *~;
#X obj 140 330 *~;
#X obj 78 197 == 0;
#X obj 78 223 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000 0 1;
#X connect 0 0 12 0;
#X connect 1 0 13 0;
#X connect 2 0 5 0;
#X connect 3 0 4 0;
#X connect 5 0 14 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 13 1;
#X connect 8 0 9 0;
#X connect 9 0 5 0;
#X connect 10 0 11 0;
#X connect 11 0 12 1;
#X connect 12 0 3 0;
#X connect 13 0 3 1;
#X connect 14 0 15 0;
#X connect 15 0 10 0;
#X restore 16 708 pd srcselect;
#X f 53;
#X obj 223 670 cnv 15 15 15 empty empty empty 20 12 0 14 #c6ffc7 #404040 0;
#X obj 383 668 vradio 15 1 0 2 empty empty empty 0 -8 0 10 #fcfcfc #000000 #000000 0;
#X text 401 664 source;
#X text 401 682 oscillator resynth;
#X obj 16 610 delread~ \$0-latencycomp 1, f 19;
#X obj 16 583 expr $f1*1000/samplerate;
#X msg 38 403 getlatency;
#X obj 200 450 fluid.melbands~ 120;
#X floatatom 330 476 5 0 0 0 - - - 0;
#X obj 16 497 delwrite~ \$0-latencycomp 3000, f 20;
#X msg 309 418 numbands \$1;
#X msg 411 418 minfreq \$1;
#X msg 513 418 maxfreq \$1;
#X floatatom 301 391 8 1 120 0 - - - 0;
#X floatatom 403 391 8 0 0 0 - - - 0;
#X floatatom 505 391 8 0 0 0 - - - 0;
#X obj 403 343 loadbang;
#X msg 403 368 20;
#X msg 505 368 20000;
#X msg 301 368 40;
#X text 502 283 experiment with the number of bands \, minimum and maximum frequencies, f 16;
#N canvas 0 23 797 885 oscillators 0;
#X floatatom 242 122 8 1 40 0 - - - 0;
#X floatatom 322 122 8 0 0 0 - - - 0;
#X floatatom 396 122 8 0 0 0 - - - 0;
#N canvas 1386 23 662 502 melbandcalculator 0;
#X obj 35 52 inlet;
#X obj 245 51 inlet;
#X obj 180 48 inlet;
#X text 32 27 nb bands;
#X text 245 28 low freq;
#X text 179 30 high freq;
#X obj 245 87 expr 1127.01 * log(($f1/700.) +1.);
#X text 482 85 converts Hz to Mel;
#X obj 181 115 expr 1127.01 * log(($f1/700.) +1.);
#X obj 181 184 -;
#X obj 246 146 t b f;
#X obj 106 246 expr $f2 / ($f1 + 1);
#X obj 179 207 t b f;
#X obj 35 279 until;
#X msg 35 299 1;
#X obj 35 320 +;
#X obj 35 341 t f f f;
#X obj 34 453 outlet;
#X obj 35 432 pack f f;
#X text 248 247 makes a range \, and splits it evenly in Mel;
#X text 102 401 calculate the position of the centre of each band in mel \, then converts them all back in Hz;
#X msg 71 299 -1;
#X obj 54 378 expr (exp(((($f1 + 1) * $f2) + $f3) / 1127.01048) - 1 ) * 700, f 62;
#X obj 35 167 f;
#X obj 35 82 t b f;
#X obj 35 188 t f b f;
#X connect 0 0 24 0;
#X connect 1 0 6 0;
#X connect 2 0 8 0;
#X connect 6 0 10 0;
#X connect 8 0 9 0;
#X connect 9 0 12 0;
#X connect 10 0 9 0;
#X connect 10 1 9 1;
#X connect 10 1 22 2;
#X connect 11 0 22 1;
#X connect 12 0 23 0;
#X connect 12 1 11 1;
#X connect 13 0 14 0;
#X connect 14 0 15 0;
#X connect 15 0 16 0;
#X connect 16 0 18 0;
#X connect 16 1 22 0;
#X connect 16 2 15 1;
#X connect 18 0 17 0;
#X connect 21 0 15 1;
#X connect 22 0 18 1;
#X connect 23 0 25 0;
#X connect 24 0 23 0;
#X connect 24 1 23 1;
#X connect 25 0 13 0;
#X connect 25 1 21 0;
#X connect 25 2 11 0;
#X restore 286 232 pd melbandcalculator;
#X obj 58 265 list prepend all;
#X obj 58 288 list trim;
#N canvas 0 38 629 365 modulator 0;
#X obj 77 81 osc~ 0.21;
#X obj 77 102 snapshot~;
#X obj 295 103 snapshot~;
#X obj 295 82 osc~ 0.19;
#X obj 359 83 metro 20;
#X obj 77 121 expr 20 * pow(4 \, (($f1 + 1.) / 2.));
#X obj 295 124 expr 5000 * pow(4 \, (($f1 + 1.) / 2.));
#X obj 77 142 outlet;
#X obj 295 145 outlet;
#X obj 359 63 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000 0 1;
#X text 296 43 switch on the mod;
#X connect 0 0 1 0;
#X connect 1 0 5 0;
#X connect 2 0 6 0;
#X connect 3 0 2 0;
#X connect 4 0 2 0;
#X connect 4 0 1 0;
#X connect 5 0 7 0;
#X connect 6 0 8 0;
#X connect 9 0 4 0;
#X restore 577 35 pd modulator;
#X obj 58 334 outlet~;
#X text 113 65 from melbands;
#X obj 59 66 inlet;
#X obj 242 66 inlet;
#X obj 322 66 inlet;
#X obj 396 66 inlet;
#X floatatom 313 269 5 0 0 0 - - - 0;
#X obj 58 311 clone fluid.melbands.polyoscil 120;
#X connect 0 0 3 0;
#X connect 1 0 3 2;
#X connect 2 0 3 1;
#X connect 3 0 13 0;
#X connect 3 0 14 1;
#X connect 4 0 5 0;
#X connect 5 0 14 0;
#X connect 6 0 1 0;
#X connect 6 1 2 0;
#X connect 9 0 4 0;
#X connect 10 0 0 0;
#X connect 11 0 1 0;
#X connect 12 0 2 0;
#X connect 14 0 7 0;
#X restore 200 543 pd oscillators;
#X f 44;
#X obj 501 733 cnv 15 177 42 empty empty More\ information 4 10 0 13 #e0e0e0 #404040 0;
#N canvas 354 25 691 897 visualising_mel_bands 0;
#X obj 17 13 cnv 15 660 42 empty empty fluid.melbands~ 1 22 0 36 #4ba3fb #ffffff 0;
#X text 15 84 Visualising mel bands;
#X obj 15 176 fluid.demosound~;
#X obj 16 155 cnv 15 15 15 empty empty empty 20 12 0 14 #c6ffc7 #404040 0;
#X obj 107 299 fluid.out~ nmffilterhelp;
#X obj 17 499 fluid.melbands~ 80;
#X obj 17 709 array set help.melbands.vis;
#N canvas 990 342 450 278 (subpatch) 0;
#X array help.melbands.vis 80 float 2;
#X coords 0 0.15 80 0 300 100 1 0 0;
#X restore 19 777 graph;
#X text 218 655 Smoothing the mel bands output makes it a bit easier to visualise it, f 42;
#X text 236 512 More mel bands increases the precision of the model \, but will never go higher than the first argument (maxnumbands) \, and will always output that number of elementsin a list. Changing the lowest and highest frequency modelled is helpful to focus the descriptor on a useful range.;
#N canvas 1114 23 857 601 parameters 0;
#X obj 186 331 outlet;
#X obj 34 -62 loadbang;
#X obj 186 4 r help.melbands.presets;
#X msg 34 -37 \; help.melbands.presets 80 1024 -1 -1 20 20000;
#X obj 186 27 unpack 0 0 0 0 0 0;
#X floatatom 245 127 8 -1 0 0 - - - 0;
#X floatatom 185 126 8 0 0 0 - - - 0;
#X floatatom 185 105 8 1 80 0 - - - 0;
#X floatatom 305 127 8 -1 0 0 - - - 0;
#X text 104 126 fftsettings;
#X obj 286 218 pack 0 0 0;
#X msg 286 241 fftsettings \$1 \$2 \$3;
#X text 111 105 numbands, f 10;
#X msg 81 240 numbands \$1;
#X msg 456 241 minfreq \$1;
#X msg 556 241 maxfreq \$1;
#X floatatom 185 147 8 -20 0 0 - - - 0;
#X floatatom 185 168 8 20 20000 0 - - - 0;
#X text 111 147 minfreq, f 10;
#X text 111 168 maxfreq, f 10;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 4 0 7 0;
#X connect 4 1 6 0;
#X connect 4 2 5 0;
#X connect 4 3 8 0;
#X connect 4 4 16 0;
#X connect 4 5 17 0;
#X connect 5 0 10 1;
#X connect 6 0 10 0;
#X connect 7 0 13 0;
#X connect 8 0 10 2;
#X connect 10 0 11 0;
#X connect 11 0 0 0;
#X connect 13 0 0 0;
#X connect 14 0 0 0;
#X connect 15 0 0 0;
#X connect 16 0 14 0;
#X connect 17 0 15 0;
#X coords 0 -1 1 1 294 90 2 100 100;
#X restore 224 343 pd parameters;
#X text 369 456 <-- more parameters;
#N canvas 1216 23 832 913 parameters 0;
#X obj 439 307 s \$0-params;
#X obj 29 757 r \$0-params;
#X obj 29 780 outlet;
#X text 28 6 Optional parameters to fluid.bufaudiotransport;
#X obj 29 125 s \$0-params;
#X text 192 158 for hopsize \, -1 = windowsize/2, f 24;
#X text 193 100 window size (1024) \, hop size (-1) \, fft size (-1), f 24;
#X text 192 199 for fftsize \, -1 = windowsize snapped to nearest power of 2, f 24;
#X obj 439 119 s \$0-params;
#X obj 29 323 s \$0-params;
#X obj 29 285 cnv 10 233 2 empty empty empty 20 12 0 14 #bbbbbb #404040 0;
#X obj 29 74 cnv 10 310 2 empty empty empty 20 12 0 14 #bbbbbb #404040 0;
#X text 27 54 FFT settings;
#X obj 441 424 cnv 10 233 2 empty empty empty 20 12 0 14 #bbbbbb #404040 0;
#X obj 439 257 cnv 10 280 2 empty empty empty 20 12 0 14 #bbbbbb #404040 0;
#X obj 439 74 cnv 10 200 2 empty empty empty 20 12 0 14 #bbbbbb #404040 0;
#X msg 29 102 fftsettings 1024 -1 1;
#X text 27 265 Max FFT size;
#X text 439 404 Warnings;
#X obj 442 503 s \$0-params;
#X msg 442 446 warnings 1;
#X msg 452 468 warnings 0;
#X text 531 445 warnings;
#X text 531 467 or no warnings;
#X msg 29 300 maxfftsize -1;
#X text 138 295 Set an explicit upper bound on the FFT size at object instantiation. The default of -1 sets this to whatever the initial FFT size is, f 33;
#X text 437 54 Filter Min and Max frequencies;
#X msg 439 96 maxfreq 20000;
#X text 549 94 upper bound of the frequency band to use in analysis \, in Hz., f 33;
#X obj 439 179 s \$0-params;
#X msg 439 156 minfreq 20000;
#X text 549 154 lower bound of the frequency band to use in analysis \, in Hz., f 33;
#X text 437 238 Maxnumbands;
#X msg 439 284 maxnumbands -1;
#X text 551 283 maximum value for numbands. Can only be set at object instantiation. The default of -1 sets this equal to the initial value of numbands, f 33;
#X obj 29 478 s \$0-params;
#X obj 29 428 cnv 10 280 2 empty empty empty 20 12 0 14 #bbbbbb #404040 0;
#X text 27 409 Scaling;
#X msg 29 455 normalize 1;
#X text 141 454 flag to use normalized triangle filters. When normalization is off \, the higher MelBands tend to be disproportionately large because they are summing more FFT magnitudes. Default is on (1)., f 33;
#X obj 29 588 s \$0-params;
#X msg 29 565 scale 0;
#X text 141 564 scaling of the output value \, linear (0 \, by default) or in dB (1)., f 33;
#X connect 1 0 2 0;
#X connect 16 0 4 0;
#X connect 20 0 19 0;
#X connect 21 0 19 0;
#X connect 24 0 9 0;
#X connect 27 0 8 0;
#X connect 30 0 29 0;
#X connect 33 0 0 0;
#X connect 38 0 35 0;
#X connect 41 0 40 0;
#X restore 266 453 pd parameters;
#X obj 17 657 fluid.stats 80 -history 5;
#X obj 177 304 cnv 15 15 15 empty empty empty 20 12 0 14 #c6ffc7 #404040 0;
#X text 177 302 1) audio on;
#X text 18 154 2) select a source;
#X connect 2 0 4 0;
#X connect 2 0 4 1;
#X connect 2 0 5 0;
#X connect 5 0 13 0;
#X connect 10 0 5 0;
#X connect 12 0 5 0;
#X connect 13 0 6 0;
#X restore 503 753 pd visualising_mel_bands;
#X text 87 745 1) audio on;
#N canvas 68 97 450 300 getsr 0;
#X obj 35 71 r pd-dsp-started;
#X obj 45 96 samplerate~;
#X obj 126 146 value samplerate;
#X obj 160 70 loadbang;
#X obj 45 120 t b f;
#X obj 45 144 outlet;
#X connect 0 0 1 0;
#X connect 1 0 4 0;
#X connect 3 0 1 0;
#X connect 4 0 5 0;
#X connect 4 1 2 0;
#X restore 37 378 pd getsr;
#X obj 23 132 cnv 15 15 15 empty empty empty 20 12 0 14 #c6ffc7 #404040 0;
#X text 24 132 2) select a source;
#X text 223 668 3) select what to listen to source/synth, f 22;
#X connect 4 0 17 0;
#X connect 4 0 15 0;
#X connect 7 0 6 0;
#X connect 7 0 6 1;
#X connect 9 0 7 2;
#X connect 12 0 7 0;
#X connect 13 0 12 0;
#X connect 14 0 15 0;
#X connect 15 0 29 0;
#X connect 15 1 16 0;
#X connect 16 0 13 0;
#X connect 18 0 15 0;
#X connect 19 0 15 0;
#X connect 20 0 15 0;
#X connect 21 0 18 0;
#X connect 21 0 29 1;
#X connect 22 0 19 0;
#X connect 22 0 29 2;
#X connect 23 0 20 0;
#X connect 23 0 29 3;
#X connect 24 0 27 0;
#X connect 24 0 25 0;
#X connect 24 0 26 0;
#X connect 25 0 22 0;
#X connect 26 0 23 0;
#X connect 27 0 21 0;
#X connect 29 0 7 1;
